import{a as w,b as j,c as A,d as p,e as P,h as x,i as D,j as Q,k as I,l as _,m as E,n as F,p as g,q as k,r as T,s as q,t as N,u as U,v as z,w as C}from"./chunk-JXLBYLCV.js";import{a as S}from"./chunk-UWSAOII3.js";import"./chunk-SVBTIPYH.js";import{d as b}from"./chunk-RRU7Q3KP.js";var e=b(S());var d=b(S());function L(t,r){return t.find(n=>n.name==r)}function y(t){let r=t.quota-t.usage;return r>0?r:0}function W(t,r){let n=new D(r),i=y(t);return Q(i,n)}function K(t,r,n){let i=t.categories[r].resources,a=n.map(o=>{let s=L(i,o);if(!s)return;let u=s.unit?W(s,s.unit):y(s);return{name:o,value:u}});return d.default.createElement("span",null,a.map(o=>{if(!(!o?.name||!o.value))return d.default.createElement(d.default.Fragment,{key:o.name},o.value," ",x(o.name)," ")}))}var H=K;var V=t=>{let{quotaProject:r}=t,{projectData:n}=q(),{setProjectData:i}=N(),{restructureReport:a}=T(),o=E({queryKey:["projectData"]}),{data:s,isLoading:u,isError:l,error:m}=o,[h,v]=e.default.useState(null),[f,c]=e.default.useState({type:null,resources:[]}),B=F(),G=t.quotaAlign?t.quotaAlign:"end";return e.default.useEffect(()=>{if(r)switch(r){case"compute":c({type:"compute",resources:["instances","cores","ram"]});break;case"block_storage":c({type:"volumev2",resources:["volumes","snapshots","capacity"]});break;case"lbaas2":c({type:"loadbalancing",resources:["loadbalancers","listeners","pools","l7policies"]});break;case"networking":c({type:"networking",resources:["floating_ips","networks","subnets","routers","security_groups"]});break;case"shared_filesystem_storage":c({type:"sharev2",resources:["share_capacity","shares","share_snapshots","share_networks","snapshot_capacity"]});break;case"dns_service":c({type:"dns",resources:["zones","recordsets"]});break;case"keppel":c({type:"keppel",resources:["images"]});break;case"object_storage":c({type:"object-store",resources:["capacity"]});break;default:v(null);break}},[r]),e.default.useEffect(()=>{s&&i(a(s.project))},[s]),e.default.useEffect(()=>{!n||!f.type||v(H(n,f.type,f.resources))},[n,f]),f.type?l?e.default.createElement(e.default.Fragment,null,console.log(m)):u?e.default.createElement(P,{variant:"primary",size:"small"}):h&&e.default.createElement(p,{direction:"horizontal",distribution:G,gap:"1"},e.default.createElement(p,{className:"text-[#888888]",direction:"horizontal",distribution:"start",alignment:"center",gap:"1"},e.default.createElement(A,{icon:"monitorHeart",size:"16px"}),e.default.createElement("div",{className:"text-xs whitespace-nowrap"},"Remaining Quota:")),e.default.createElement("a",{href:B},e.default.createElement(p,{className:"hover:underline  text-[#888888] hover:text-[#555555]",direction:"horizontal",distribution:"start",alignment:"start"},e.default.createElement("div",{className:"text-xs text-justify"},h)))):e.default.createElement(e.default.Fragment,null)},$=t=>{let{queryClient:r}=t,{apiReady:n}=g(),{token:i}=g(),{setToken:a}=k(),{setGlobalAPI:o}=k(),[s,u]=e.default.useState(!1);e.default.useEffect(()=>{l()},[]),e.default.useEffect(()=>{i&&u(!1)},[i]);async function l(){if(!window[t.getTokenFuncName]){a(t.token);return}let m=await window[t.getTokenFuncName]();a(m.authToken)}return e.default.useEffect(()=>{l()},[]),e.default.useEffect(()=>{o({endpoint:t.endpoint||t.currentHost||"",projectID:t.projectID||projectID||"",domainID:t.domainID||""})},[]),s?e.default.createElement(e.default.Fragment,null,console.log("Failed to fetch a token. Please provide a token as property or provide a getTokenFunc.")):e.default.createElement(_,{client:r},e.default.createElement(C,{mockAPI:t.mockAPI}),e.default.createElement(w,{embedded:!0},n&&e.default.createElement(V,{...t})))},J=t=>{let r=new I;return!t.projectID||!t.domainID?null:e.default.createElement(j,{theme:`${t.theme?t.theme:"theme-dark"}`},e.default.createElement("style",null,z.toString()),e.default.createElement(U,null,e.default.createElement($,{...t,queryClient:r})))},ae=J;export{ae as default};
